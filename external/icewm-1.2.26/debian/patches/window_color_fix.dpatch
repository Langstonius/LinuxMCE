#!/bin/sh -e
## versioned_session.dpatch by Eduard Bloch <blade@debian.org>
##
## DP: Custom name extension of all icewm programs executed from
## icewm-session and hotkeys for theme submenues

if [ $# -ne 1 ]; then
    echo >&2 "`basename $0`: script expects -patch|-unpatch as argument"
    exit 1
fi

[ -f debian/patches/00patch-opts ] && . debian/patches/00patch-opts
patch_opts="${patch_opts:--f --no-backup-if-mismatch}"

case "$1" in
       -patch) patch $patch_opts -p1 < $0;;
       -unpatch) patch $patch_opts -p1 -R < $0;;
        *)
                echo >&2 "`basename $0`: script expects -patch|-unpatch as argument"
                exit 1;;
esac

exit 0

@DPATCH@
diff -r -u icewm-1.2.23/src/decorate.cc icewm-patched/src/decorate.cc
--- icewm-1.2.23/src/decorate.cc	2005-08-14 20:33:08.000000000 +0200
+++ icewm-patched/src/decorate.cc	2005-12-04 14:39:19.000000000 +0100
@@ -215,7 +215,7 @@
         Pixmap shape(YPixmap::createMask(width(), height()));
         Graphics g(shape, width(), height());
 
-        g.setColor(YColor::white);
+        g.setColor((unsigned long) 1);
         g.fillRect(0, 0, width(), height());
 
         const int xTL(frameTL[t][a] != null ? frameTL[t][a]->width() : 0),
Only in icewm-1.2.23/src/: Makefile
Only in icewm-1.2.23/src/: wmapp.cc
diff -r -u icewm-1.2.23/src/wmframe.cc icewm-patched/src/wmframe.cc
--- icewm-1.2.23/src/wmframe.cc	2005-08-14 20:33:08.000000000 +0200
+++ icewm-patched/src/wmframe.cc	2005-12-04 14:42:07.000000000 +0100
@@ -2254,9 +2254,9 @@
             ref<YPixmap> img(new YPixmap(w, h));
             Graphics g(img, 0, 0);
 
-            g.setColor(YColor::white);
+            g.setColor((unsigned long) 1);
             g.fillRect(0, 0, w, h);
-            g.setColor(YColor::black);
+            g.setColor((unsigned long) 0);
             g.setClipMask(pixmap);
             g.fillRect(0, 0, w, h);
 
diff -r -u icewm-1.2.23/src/yimage.cc icewm-patched/src/yimage.cc
--- icewm-1.2.23/src/yimage.cc	2005-08-14 20:33:08.000000000 +0200
+++ icewm-patched/src/yimage.cc	2005-12-04 14:44:02.000000000 +0100
@@ -172,10 +172,10 @@
         fMask = createMask(nw, nh);
         Graphics g(fMask, nw, nh);
 
-        g.setColor(YColor::white);
+        g.setColor((unsigned long) 1);
         g.fillRect(0, 0, nw, nh);
 
-        g.setColor(YColor::black);
+        g.setColor((unsigned long) 0);
 //
 // nested rendering loop inspired by gdk-pixbuf
 //
diff -r -u icewm-1.2.23/src/ypaint.cc icewm-patched/src/ypaint.cc
--- icewm-1.2.23/src/ypaint.cc	2005-08-14 20:33:08.000000000 +0200
+++ icewm-patched/src/ypaint.cc	2005-12-04 14:29:56.000000000 +0100
@@ -591,6 +591,10 @@
     XSetForeground(fDisplay, gc, fColor->pixel());
 }
 
+void Graphics::setColor(unsigned long pixel) {
+    XSetForeground(fDisplay, gc, pixel);
+}
+
 void Graphics::setFont(ref<YFont> aFont) {
     fFont = aFont;
 }
diff -r -u icewm-1.2.23/src/ypaint.h icewm-patched/src/ypaint.h
--- icewm-1.2.23/src/ypaint.h	2005-08-14 20:33:08.000000000 +0200
+++ icewm-patched/src/ypaint.h	2005-12-04 14:30:40.000000000 +0100
@@ -245,6 +245,7 @@
                      int const mode);
     void fillArc(int x, int y, int width, int height, int a1, int a2);
     void setColor(YColor * aColor);
+    void setColor(unsigned long pixel);
     void setFont(ref<YFont> aFont);
     void setThinLines(void) { setLineWidth(0); }
     void setWideLines(int width = 1) { setLineWidth(width >= 1 ? width : 1); }
